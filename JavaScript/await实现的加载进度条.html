<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>await实现的加载进度条</title>
    <style>
      div {
        height: 50px;
        width: 500px;
      }
      #loading {
        height: 100%;
        width: 0%;
        background-color: #3e0849;
        text-align: center;
        color: #ffffff;
        line-height: 50px;
        font-size: x-large;
      }
    </style>
  </head>
  <body>
    <div>
      <div id="loading"></div>
    </div>
    <script>
      "use strict";
      /*该方法传入一个可迭代的对象和一个回调函数,
       *每次迭代对象中的元素并执行回调函数
       *根据迭代的进度设置进度条的宽度
       *@method loadingBar
       *@param {iterable}items
       *@param {callback}callback,可接收一个当前迭代到的元素
       *@param {DOMElement}element,作为进度条显示的DOM元素
       *@return {void}
       */
      async function loadingBar(items, element, callback) {
        for (let i = 0; i < items.length; i++) {
          await callback(items[i]);
          let progress = ((i + 1) / items.length) * 100;
          element.style.width = progress + "%";
          element.innerHTML = Math.round(progress) + "%";
        }
      }

      loadingBar([1, 2, 3, 4, 5], loading, (item) => {
        return new Promise((resolve) => {
          setTimeout(() => {
            console.log(item);
            resolve();
          }, 1000);
        });
      });
    </script>
  </body>
</html>
